# 进销存 BI 系统 - 主流交互与功能规范 (Reference: PowerBI/Tableau)

## 1. 核心图表交互 (Chart Interactions)
市面上主流 BI 的图表不仅仅是静态图片，必须具备以下交互能力：

### 1.1 数据提示 (Tooltip)
* **逻辑**：鼠标悬停 (Hover) 在图表的某个数据点（如柱子、折线点、饼图扇区）上时。
* **表现**：弹出一个浮层，显示该点的详细维度信息、具体数值、以及占比。
* **Cursor 指令**：`Ensure all ECharts have 'tooltip' enabled with 'trigger: "axis"' for line/bar and 'trigger: "item"' for pie charts.`

### 1.2 图表联动 (Cross-Filtering / Linkage)
* **逻辑**：当用户点击“分公司销售占比”饼图中的“华东分公司”扇区时。
* **表现**：页面上**其他所有图表**（如趋势图、排行榜）自动触发筛选，只显示“华东分公司”的数据。再次点击则取消筛选。
* **实现难度**：中等（需要前端维护一个全局 Filter 对象）。
* **替代方案**：如果开发成本有限，可先做“点击跳转详情”。

### 1.3 数据下钻 (Drill-down)
* **逻辑**：用户觉得“年度数据”太粗，想看“月度”；或者觉得“分类数据”太粗，想看“单品”。
* **交互**：
    * **方式 A (双击)**：双击柱状图，进入下一级维度。
    * **方式 B (右键菜单)**：右键点击 -> 选择“下钻到...”。
    * **方式 C (面包屑)**：图表左上角显示路径 `所有 > 华东 > 上海`，点击返回上一级。

### 1.4 图表缩放 (Data Zoom)
* **逻辑**：当折线图展示 365 天的数据时，太密集看不清。
* **交互**：图表底部提供“滑动条 (Slider)”，允许用户拖拽选择时间范围，放大查看局部细节。

## 2. 筛选器交互 (Filter Bar Logic)

### 2.1 全局筛选 (Global Filter)
* **位置**：通常位于 Dashboard 顶部。
* **逻辑**：
    * **时间控件**：支持快捷键（近7天、本月、本季、本年）+ 自定义范围。
    * **级联选择**：选择“华东大区”后，“分公司”下拉框只显示华东下的公司。
    * **查询触发**：
        * **立即触发**：选中即刷新（适合数据量小）。
        * **手动触发**：点击“查询”按钮后刷新（适合数据量大，**推荐**）。

### 2.2 标签页切换 (Tab Switching)
* **逻辑**：在同一个 Dashboard 内，按主题切换视图（如：销售视图 | 库存视图 | 财务视图）。
* **表现**：切换 Tab 时，URL 参数应随之变化（方便分享链接），且保留当前的筛选条件。

## 3. 表格交互规范 (Table Logic)
表格是 BI 中最基础但也最复杂的组件，需对标 **Ag-Grid** 或 **Excel** 的体验。

* **固定表头**：向下滚动时，表头吸顶。
* **固定列**：向右滚动时，关键列（如“商品名称”）固定在左侧。
* **列排序**：点击表头可进行升序/降序/取消排序。
* **行样式**：
    * **斑马纹**：单双行背景色区分。
    * **Hover 高亮**：鼠标滑过某一行，该行高亮。
* **分页器**：显示“共 X 条，前往第 Y 页”，支持调整“每页显示 N 条”。

## 4. 智能问答交互 (ChatBI Specific)
这是 AI BI 的特有逻辑，参照 **ChatGPT / Copilot** 的标准。

* **流式输出 (Streaming)**：AI 的文字回复必须是一个字一个字打出来的，不能等 5 秒后这坨文字突然出现（减少用户焦虑）。
* **加载状态 (Loading State)**：
    * **Thinking**：显示“AI 正在思考...”或“正在生成 SQL...”。
    * **Querying**：显示“正在查询数据库...”。
    * **Rendering**：显示“正在渲染图表...”。
* **引用溯源**：AI 回复的结论下方，最好有个小字“查看原始 SQL”或“数据来源”，增加可信度。
* **快捷追问**：AI 回复完后，提供 3 个“猜你想问”的胶囊按钮（如“按月份拆分看看”、“只看 Top 10”）。

## 5. 移动端/大屏适配 (Responsiveness)
* **断点逻辑**：
    * **PC 宽屏 (>1440px)**：一行显示 4 个 KPI 卡片。
    * **笔记本 (1024px - 1440px)**：一行显示 3 个。
    * **平板/手机 (<768px)**：强制单列布局，图表高度自动减小，隐藏复杂表格。